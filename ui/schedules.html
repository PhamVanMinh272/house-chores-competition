<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weekly Chore Schedule</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .body {
      font-family: Arial, sans-serif;
      color: #363535;
    }
    .card-title {
      font-size: 13px;
      color: #363535;
    }
    .card-text {
      font-size: 12px;
      color: #363535;
    }
    .schedule-card {
      margin-bottom: 10px;
    }
    .status-Pending { background-color: #b6d8fa; }
    .status-InProgress { background-color: #cce5ff; }
    .status-Done { background-color: #d4edda; }
    .status-FullyReviewed { background-color: #e2e3e5; }
  </style>
</head>
<body class="container my-4">
  <h1 class="mb-4">Weekly Chore Schedule (Group 1)</h1>

  <div class="row text-center mb-3">
    <div class="col">Monday</div>
    <div class="col">Tuesday</div>
    <div class="col">Wednesday</div>
    <div class="col">Thursday</div>
    <div class="col">Friday</div>
    <div class="col">Saturday</div>
    <div class="col">Sunday</div>
  </div>

  <div class="row" id="scheduleRow">
    <div class="col" id="day-1"></div>
    <div class="col" id="day-2"></div>
    <div class="col" id="day-3"></div>
    <div class="col" id="day-4"></div>
    <div class="col" id="day-5"></div>
    <div class="col" id="day-6"></div>
    <div class="col" id="day-0"></div>
  </div>

  <script>
    async function fetchSchedules() {
      try {
        const response = await fetch('http://127.0.0.1:5000/api/schedules?groupId=1');
        const data = await response.json();
        renderSchedules(data.data);
      } catch (err) {
        console.error('Error fetching schedules:', err);
      }
    }

    function renderSchedules(schedules) {
      // Clear existing
      document.querySelectorAll('#scheduleRow .col').forEach(col => col.innerHTML = '');

      schedules.forEach(sch => {
        const date = new Date(sch.scheduleDate);
        const dayOfWeek = date.getDay(); // Sunday=0, Monday=1, ...
        const cell = document.getElementById(`day-${dayOfWeek}`);
        if (cell) {
          const card = document.createElement('div');
          card.className = `card schedule-card status-${sch.status}`;
          card.innerHTML = `
            <div class="card-body p-2">
              <h6 class="card-title mb-1">${sch.chore.name}</h6>
              <p class="card-text mb-1">
                <small>${sch.member.nickname}</small><br>
<!--                <strong>Points:</strong> ${sch.point}<br>-->
<!--                <strong>Status:</strong> ${sch.status}-->
              </p>
<!--              <small class="text-muted">${sch.comment || ''}</small>-->
            </div>
          `;
          cell.appendChild(card);
        }
      });
    }

    // Load schedules on page load
    fetchSchedules();
  </script>
</body>
</html>